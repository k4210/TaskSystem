TODO:

- inline dependency instance in gate
- cleanup