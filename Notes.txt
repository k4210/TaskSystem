TODO:

- assert no deadlocks, single guarded reaource
- cleanup